# 84. 柱状图中最大的矩形

---

## 题目描述

给定 n 个非负整数，用来表示柱状图中各个柱子的高度。每个柱子彼此相邻，且宽度为 1 。

求在该柱状图中，能够勾勒出来的矩形的最大面积。

---

## 左小等单调栈：头哨兵、尾哨兵

单调栈配合哨兵还是比较好的，不用判断单调栈是否为空。
另外，小于等于这个关系很重要，具体见注释。
直观点想，也是能理解的。如果在柱体后面拼接一个等高柱体，是不用弹栈的。
所以栈顶元素只要小于等于新元素即可，不用严格小于。

```python3
class Solution:
    def largestRectangleArea(self, heights: List[int]) -> int:
        st = [0]
        ans = 0
        hs = [0, *heights, 0]
        
        def check(x):
            # 注意这个等于号非常重要，否则会出现越界
            # 如果柱体高度相等，是不用弹出来的，最靠左的柱体将得到正确计算
            # 另外由于左右各加了两个哨兵值 0
            # 当尾哨兵和头哨兵进行比较时，加上等于号不会弹出头哨兵
            # 并且会自动结束循环
            return hs[st[-1]] <= x

        for i, h in enumerate(hs):
            while not check(h):
                ans = max(ans, hs[st.pop()] * (i - st[-1] - 1))
            st.append(i)
        
        return ans
```

> 执行结果：通过
> 执行用时 :72 ms, 在所有 Python3 提交中击败了59.79% 的用户
> 内存消耗 :15.4 MB, 在所有 Python3 提交中击败了11.11%的用户

---

`2020.5.31`
